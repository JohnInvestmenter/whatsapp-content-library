<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WhatsApp Format Converter - Rich Text to WhatsApp Markdown</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 900px;
      width: 100%;
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .header p {
      font-size: 16px;
      opacity: 0.95;
    }

    .content {
      padding: 30px;
    }

    .section {
      margin-bottom: 30px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .textarea-container {
      position: relative;
    }

    textarea {
      width: 100%;
      min-height: 150px;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      font-size: 15px;
      font-family: inherit;
      resize: vertical;
      transition: border-color 0.3s;
    }

    textarea:focus {
      outline: none;
      border-color: #25D366;
    }

    #input {
      background: #f8f9fa;
    }

    #output {
      background: #fff;
      font-family: 'Courier New', monospace;
      color: #333;
    }

    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    button {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #25D366;
      color: white;
    }

    .btn-primary:hover {
      background: #1fa855;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4);
    }

    .btn-secondary {
      background: #667eea;
      color: white;
    }

    .btn-secondary:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .instructions {
      background: #f0f7ff;
      border-left: 4px solid #667eea;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }

    .instructions h3 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 18px;
    }

    .instructions ol {
      margin-left: 20px;
      line-height: 1.8;
    }

    .instructions li {
      margin-bottom: 8px;
    }

    .examples {
      background: #fff8e1;
      border-left: 4px solid #ffa726;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }

    .examples h3 {
      color: #f57c00;
      margin-bottom: 15px;
      font-size: 18px;
    }

    .example-item {
      margin-bottom: 15px;
      padding: 10px;
      background: white;
      border-radius: 6px;
    }

    .example-label {
      font-weight: 600;
      color: #666;
      font-size: 13px;
      margin-bottom: 5px;
    }

    .example-text {
      font-family: 'Courier New', monospace;
      color: #333;
    }

    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #333;
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      display: none;
      align-items: center;
      gap: 10px;
      z-index: 1000;
      animation: slideIn 0.3s ease;
    }

    .toast.show {
      display: flex;
    }

    .toast.success {
      background: #25D366;
    }

    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .icon {
      width: 24px;
      height: 24px;
    }

    .divider {
      height: 1px;
      background: linear-gradient(to right, transparent, #e0e0e0, transparent);
      margin: 30px 0;
    }

    @media (max-width: 600px) {
      .header h1 {
        font-size: 22px;
      }

      .content {
        padding: 20px;
      }

      .button-group {
        flex-direction: column;
      }

      button {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>
        <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
        </svg>
        WhatsApp Format Converter
      </h1>
      <p>Convert rich text formatting to WhatsApp markdown instantly</p>
    </div>

    <div class="content">
      <div class="instructions">
        <h3>üìã How to Use</h3>
        <ol>
          <li><strong>Format your text</strong> in Google Docs, Microsoft Word, or any rich text editor</li>
          <li><strong>Copy</strong> the formatted text (Ctrl/Cmd + C)</li>
          <li><strong>Paste</strong> into the input box below (Ctrl/Cmd + V)</li>
          <li><strong>Copy</strong> the converted WhatsApp-formatted result</li>
          <li><strong>Paste</strong> into WhatsApp and send!</li>
        </ol>
      </div>

      <div class="examples">
        <h3>‚ú® Supported Formatting</h3>
        <div class="example-item">
          <div class="example-label">Bold Text:</div>
          <div class="example-text">*This is bold* ‚Üí <strong>This is bold</strong> in WhatsApp</div>
        </div>
        <div class="example-item">
          <div class="example-label">Italic Text:</div>
          <div class="example-text">_This is italic_ ‚Üí <em>This is italic</em> in WhatsApp</div>
        </div>
        <div class="example-item">
          <div class="example-label">Strikethrough Text:</div>
          <div class="example-text">~This is strikethrough~ ‚Üí <s>This is strikethrough</s> in WhatsApp</div>
        </div>
        <div class="example-item">
          <div class="example-label">Mixed Formatting:</div>
          <div class="example-text">*Bold text*, normal text, _italic text_, and *_bold italic_*</div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">
          <span>üìù</span>
          <span>Input: Paste Formatted Text Here</span>
        </div>
        <div class="textarea-container">
          <textarea
            id="input"
            placeholder="Paste your formatted text from Google Docs, Word, or any rich text editor here...&#10;&#10;Try copying text with bold, italic, or strikethrough formatting!"
          ></textarea>
        </div>
        <div class="button-group">
          <button class="btn-secondary" id="clearBtn">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
            </svg>
            Clear
          </button>
        </div>
      </div>

      <div class="divider"></div>

      <div class="section">
        <div class="section-title">
          <span>‚úÖ</span>
          <span>Output: WhatsApp-Formatted Text</span>
        </div>
        <div class="textarea-container">
          <textarea
            id="output"
            readonly
            placeholder="Your WhatsApp-formatted text will appear here...&#10;&#10;It will contain * for bold, _ for italic, and ~ for strikethrough."
          ></textarea>
        </div>
        <div class="button-group">
          <button class="btn-primary" id="copyBtn" disabled>
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
            </svg>
            Copy to Clipboard
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">
    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <polyline points="20 6 9 17 4 12"/>
    </svg>
    <span id="toastMessage">Copied!</span>
  </div>

  <script>
    /* ====== HTML TO WHATSAPP FORMAT CONVERTER ====== */
    function htmlToWhatsApp(html) {
      // Create a temporary div to parse HTML
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = html;

      // Helper function to get computed formatting for a node
      function getFormatting(node) {
        const formatting = { bold: false, italic: false, strikethrough: false };

        let current = node;
        while (current && current !== tempDiv) {
          if (current.nodeType === Node.ELEMENT_NODE) {
            const tagName = current.tagName.toLowerCase();

            // Check tag names
            if (!formatting.bold && (tagName === 'strong' || tagName === 'b')) {
              formatting.bold = true;
            }
            if (!formatting.italic && (tagName === 'em' || tagName === 'i')) {
              formatting.italic = true;
            }
            if (!formatting.strikethrough && (tagName === 's' || tagName === 'strike' || tagName === 'del')) {
              formatting.strikethrough = true;
            }

            // Check inline styles
            if (current.style) {
              if (!formatting.bold) {
                const fontWeight = current.style.fontWeight;
                if (fontWeight === 'bold' || fontWeight === '700' || parseInt(fontWeight) >= 600) {
                  formatting.bold = true;
                }
              }
              if (!formatting.italic && current.style.fontStyle === 'italic') {
                formatting.italic = true;
              }
              if (!formatting.strikethrough) {
                const textDecor = current.style.textDecoration || current.style.textDecorationLine;
                if (textDecor && textDecor.includes('line-through')) {
                  formatting.strikethrough = true;
                }
              }
            }
          }
          current = current.parentNode;
        }

        return formatting;
      }

      // Check if element is a block-level element
      function isBlockElement(node) {
        if (node.nodeType !== Node.ELEMENT_NODE) return false;
        const tagName = node.tagName.toLowerCase();
        return ['p', 'div', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'li', 'ul', 'ol', 'blockquote', 'br'].includes(tagName);
      }

      // Collect text segments with their formatting
      const segments = [];

      function collectSegments(node) {
        if (node.nodeType === Node.TEXT_NODE) {
          const text = node.textContent;
          if (text) {
            const formatting = getFormatting(node);
            segments.push({ text, formatting });
          }
        } else if (node.nodeType === Node.ELEMENT_NODE) {
          const tagName = node.tagName.toLowerCase();

          // Handle line breaks
          if (tagName === 'br') {
            segments.push({ text: '\n', formatting: { bold: false, italic: false, strikethrough: false } });
            return;
          }

          // Handle code blocks
          if (tagName === 'code' || tagName === 'pre') {
            let text = node.textContent;
            const marker = tagName === 'pre' ? '```' : '`';
            segments.push({ text: marker + text + marker, formatting: { bold: false, italic: false, strikethrough: false } });
            return;
          }

          // Process children
          for (let child of node.childNodes) {
            collectSegments(child);
          }

          // Add line break after block elements
          if (isBlockElement(node) && segments.length > 0) {
            const lastSeg = segments[segments.length - 1];
            if (lastSeg && !lastSeg.text.endsWith('\n')) {
              segments.push({ text: '\n', formatting: { bold: false, italic: false, strikethrough: false } });
            }
          }
        }
      }

      collectSegments(tempDiv);

      // Convert segments to WhatsApp format
      let result = '';
      let currentFormatting = { bold: false, italic: false, strikethrough: false };

      for (let i = 0; i < segments.length; i++) {
        const segment = segments[i];
        const nextFormatting = segment.formatting;

        // Close formatting that's ending
        if (currentFormatting.strikethrough && !nextFormatting.strikethrough) {
          result += '~';
        }
        if (currentFormatting.italic && !nextFormatting.italic) {
          result += '_';
        }
        if (currentFormatting.bold && !nextFormatting.bold) {
          result += '*';
        }

        // Open formatting that's starting
        if (!currentFormatting.bold && nextFormatting.bold) {
          result += '*';
        }
        if (!currentFormatting.italic && nextFormatting.italic) {
          result += '_';
        }
        if (!currentFormatting.strikethrough && nextFormatting.strikethrough) {
          result += '~';
        }

        // Add the text
        result += segment.text;

        // Update current formatting
        currentFormatting = nextFormatting;
      }

      // Close any remaining formatting
      if (currentFormatting.strikethrough) result += '~';
      if (currentFormatting.italic) result += '_';
      if (currentFormatting.bold) result += '*';

      // Clean up
      result = result.replace(/\n{3,}/g, '\n\n').trim();

      return result;
    }

    /* ====== UI LOGIC ====== */
    const inputArea = document.getElementById('input');
    const outputArea = document.getElementById('output');
    const copyBtn = document.getElementById('copyBtn');
    const clearBtn = document.getElementById('clearBtn');
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toastMessage');

    // Handle paste event
    inputArea.addEventListener('paste', (e) => {
      const clipboardData = e.clipboardData || window.clipboardData;
      const htmlData = clipboardData.getData('text/html');

      if (htmlData) {
        e.preventDefault();

        // Convert HTML to WhatsApp format
        const whatsappText = htmlToWhatsApp(htmlData);

        // Insert into input area (showing the converted text)
        inputArea.value = whatsappText;

        // Also show in output
        outputArea.value = whatsappText;

        // Enable copy button
        copyBtn.disabled = false;
      }
      // If no HTML, let default paste happen
    });

    // Handle manual input changes
    inputArea.addEventListener('input', () => {
      outputArea.value = inputArea.value;
      copyBtn.disabled = inputArea.value.trim() === '';
    });

    // Copy to clipboard
    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(outputArea.value);
        showToast('Copied to clipboard! Ready to paste into WhatsApp.', 'success');
      } catch (err) {
        // Fallback for older browsers
        outputArea.select();
        document.execCommand('copy');
        showToast('Copied to clipboard! Ready to paste into WhatsApp.', 'success');
      }
    });

    // Clear all
    clearBtn.addEventListener('click', () => {
      inputArea.value = '';
      outputArea.value = '';
      copyBtn.disabled = true;
      inputArea.focus();
    });

    // Show toast notification
    function showToast(message, type = 'success') {
      toastMessage.textContent = message;
      toast.className = 'toast show ' + type;
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Focus input on load
    window.addEventListener('load', () => {
      inputArea.focus();
    });
  </script>
</body>
</html>
